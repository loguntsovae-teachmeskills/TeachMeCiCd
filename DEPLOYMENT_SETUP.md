# üöÄ –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –¥–µ–ø–ª–æ—è –Ω–∞ AWS EC2

## üìã –ß—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å

### 1Ô∏è‚É£ –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ AWS EC2 —Å–µ—Ä–≤–µ—Ä–∞

#### –ù–∞ –≤–∞—à–µ–º EC2 —Å–µ—Ä–≤–µ—Ä–µ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:

```bash
# 1. –ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ —Å–µ—Ä–≤–µ—Ä—É
ssh -i your-key.pem ubuntu@your-ec2-ip

# 2. –û–±–Ω–æ–≤–∏—Ç–µ —Å–∏—Å—Ç–µ–º—É
sudo apt update && sudo apt upgrade -y

# 3. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Python –∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã
sudo apt install -y python3 python3-pip python3-venv git curl

# 4. –°–æ–∑–¥–∞–π—Ç–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –¥–ª—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
sudo mkdir -p /home/ubuntu/app
sudo chown ubuntu:ubuntu /home/ubuntu/app

# 5. –û—Ç–∫—Ä–æ–π—Ç–µ –ø–æ—Ä—Ç 8000 –≤ Security Group
# –≠—Ç–æ –¥–µ–ª–∞–µ—Ç—Å—è –≤ AWS Console:
# EC2 ‚Üí Security Groups ‚Üí –í–∞—à–∞ –≥—Ä—É–ø–ø–∞ ‚Üí Inbound rules ‚Üí Add rule
# Type: Custom TCP, Port: 8000, Source: 0.0.0.0/0 (–∏–ª–∏ –≤–∞—à IP)
```

### 2Ô∏è‚É£ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ GitHub Secrets

–í —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ GitHub –ø–µ—Ä–µ–π–¥–∏—Ç–µ –≤: **Settings ‚Üí Secrets and variables ‚Üí Actions ‚Üí New repository secret**

–î–æ–±–∞–≤—å—Ç–µ —Å–ª–µ–¥—É—é—â–∏–µ —Å–µ–∫—Ä–µ—Ç—ã:

#### `EC2_SSH_KEY`
–°–æ–¥–µ—Ä–∂–∏–º–æ–µ –≤–∞—à–µ–≥–æ –ø—Ä–∏–≤–∞—Ç–Ω–æ–≥–æ SSH –∫–ª—é—á–∞ –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ EC2:

```bash
# –ù–∞ –≤–∞—à–µ–º –ª–æ–∫–∞–ª—å–Ω–æ–º –∫–æ–º–ø—å—é—Ç–µ—Ä–µ:
cat ~/.ssh/your-ec2-key.pem

# –ò–ª–∏ –µ—Å–ª–∏ —É –≤–∞—Å –∫–ª—é—á –æ—Ç AWS:
cat ~/Downloads/your-ec2-key.pem
```

**–°–∫–æ–ø–∏—Ä—É–π—Ç–µ –í–°–Å —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ** (–≤–∫–ª—é—á–∞—è `-----BEGIN RSA PRIVATE KEY-----` –∏ `-----END RSA PRIVATE KEY-----`) –∏ –≤—Å—Ç–∞–≤—å—Ç–µ –∫–∞–∫ –∑–Ω–∞—á–µ–Ω–∏–µ —Å–µ–∫—Ä–µ—Ç–∞.

#### `EC2_HOST`
IP –∞–¥—Ä–µ—Å –∏–ª–∏ DNS –∏–º—è –≤–∞—à–µ–≥–æ EC2 —Å–µ—Ä–≤–µ—Ä–∞:

```
# –ü—Ä–∏–º–µ—Ä—ã:
54.123.45.67
# –∏–ª–∏
ec2-54-123-45-67.compute-1.amazonaws.com
```

#### `EC2_USER`
–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–ª—è SSH (–æ–±—ã—á–Ω–æ –¥–ª—è Ubuntu AMI):

```
ubuntu
```

### 3Ô∏è‚É£ –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫ Security Group

–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤ Security Group –≤–∞—à–µ–≥–æ EC2 –æ—Ç–∫—Ä—ã—Ç—ã –ø–æ—Ä—Ç—ã:

| Type | Protocol | Port Range | Source | Description |
|------|----------|------------|--------|-------------|
| SSH | TCP | 22 | Your IP | SSH access |
| Custom TCP | TCP | 8000 | 0.0.0.0/0 | FastAPI application |

### 4Ô∏è‚É£ –°–æ–∑–¥–∞–Ω–∏–µ develop –≤–µ—Ç–∫–∏ (—É–∂–µ —Å–æ–∑–¥–∞–Ω–∞)

```bash
# –í–µ—Ç–∫–∞ develop —É–∂–µ —Å–æ–∑–¥–∞–Ω–∞
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –º–æ–∂–Ω–æ –∫–æ–º–∞–Ω–¥–æ–π:
git branch
```

### 5Ô∏è‚É£ Workflow –¥–ª—è –¥–µ–ø–ª–æ—è

–§–∞–π–ª `.github/workflows/deploy-ec2.yml` —É–∂–µ —Å–æ–∑–¥–∞–Ω –∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω.

**–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –¥–µ–ø–ª–æ–π:**
1. –ü—Ä–∏ push –≤ `main` –≤–µ—Ç–∫—É
2. –ü—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è, —á—Ç–æ —ç—Ç–æ merge –∏–∑ `develop`
3. –ó–∞–ø—É—Å–∫–∞—é—Ç—Å—è —Ç–µ—Å—Ç—ã
4. –ï—Å–ª–∏ –≤—Å—ë –û–ö - –¥–µ–ø–ª–æ–π –Ω–∞ EC2
5. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏

## üîÑ –ü—Ä–æ—Ü–µ—Å—Å —Ä–∞–±–æ—Ç—ã

### –û–±—ã—á–Ω—ã–π workflow:

```bash
# 1. –†–∞–±–æ—Ç–∞–µ—Ç–µ –≤ develop –≤–µ—Ç–∫–µ
git checkout develop

# 2. –î–µ–ª–∞–µ—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è
# ... –ø–∏—à–µ—Ç–µ –∫–æ–¥ ...

# 3. –ö–æ–º–º–∏—Ç–∏—Ç–µ –∏ –ø—É—à–∏—Ç–µ –≤ develop
git add .
git commit -m "feat: add new feature"
git push origin develop

# 4. –°–æ–∑–¥–∞–µ—Ç–µ Pull Request –∏–∑ develop –≤ main
# –ù–∞ GitHub: develop ‚Üí main

# 5. –ü–æ—Å–ª–µ —Ä–µ–≤—å—é –∏ –∞–ø–ø—Ä—É–≤–∞ - –º–µ—Ä–¥–∂–∏—Ç–µ PR

# 6. GitHub Actions –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
#    - –ó–∞–ø—É—Å—Ç–∏—Ç —Ç–µ—Å—Ç—ã
#    - –ó–∞–¥–µ–ø–ª–æ–∏—Ç –Ω–∞ EC2
#    - –ü—Ä–æ–≤–µ—Ä–∏—Ç —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å
```

### –ë—ã—Å—Ç—Ä—ã–π –¥–µ–ø–ª–æ–π —Ç–µ–∫—É—â–∏—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π:

```bash
# –ò–∑ develop –≤–µ—Ç–∫–∏
git checkout develop
git add .
git commit -m "feat: ready for deploy"
git push origin develop

# –ü–µ—Ä–µ–∫–ª—é—á–∏—Ç–µ—Å—å –Ω–∞ main –∏ —Å–º–µ—Ä–∂–∏—Ç–µ
git checkout main
git merge develop
git push origin main

# –î–µ–ø–ª–æ–π –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏!
```

## ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–µ–ø–ª–æ—è

### –ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –¥–µ–ø–ª–æ—è –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:

```bash
# 1. Health check
curl http://YOUR_EC2_IP:8000/health

# –û—Ç–≤–µ—Ç:
{
  "status": "healthy",
  "timestamp": "2025-11-17T...",
  "version": "1.0.0",
  "database": "ok"
}

# 2. Deployment status (–ù–û–í–´–ô ENDPOINT!)
curl http://YOUR_EC2_IP:8000/deployment

# –û—Ç–≤–µ—Ç:
{
  "status": "deployed",
  "deployment_info": {
    "deployed_at": "2025-11-17T18:30:00Z",
    "commit_sha": "abc123...",
    "branch": "main",
    "deployed_by": "your-username",
    "workflow_run": "42"
  },
  "current_time": "2025-11-17T18:31:00",
  "server": "AWS EC2",
  "message": "–î–µ–ø–ª–æ–π —É—Å–ø–µ—à–µ–Ω"
}

# 3. Swagger –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
curl http://YOUR_EC2_IP:8000/docs
# –ò–ª–∏ –æ—Ç–∫—Ä–æ–π—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ
```

## üêõ Troubleshooting

### –ü—Ä–æ–±–ª–µ–º–∞: SSH –∫–ª—é—á –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –Ω–∞ –∫–ª—é—á
chmod 600 your-key.pem

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –≤—Ä—É—á–Ω—É—é
ssh -i your-key.pem ubuntu@YOUR_EC2_IP

# –ï—Å–ª–∏ —Ä–∞–±–æ—Ç–∞–µ—Ç - –ø—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –≤ GitHub Secret
# —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω –∏–º–µ–Ω–Ω–æ —ç—Ç–æ—Ç –∫–ª—é—á
```

### –ü—Ä–æ–±–ª–µ–º–∞: –ü–æ—Ä—Ç 8000 –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω

```bash
# –ù–∞ EC2 —Å–µ—Ä–≤–µ—Ä–µ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:
sudo netstat -tulpn | grep 8000

# –ï—Å–ª–∏ –ø—Ä–æ—Ü–µ—Å—Å –µ—Å—Ç—å - –ø–æ—Ä—Ç –∑–∞–Ω—è—Ç
# –ï—Å–ª–∏ –Ω–µ—Ç - –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–µ –∑–∞–ø—É—Å—Ç–∏–ª–æ—Å—å

# –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –ª–æ–≥–∏:
cat /home/ubuntu/app/app.log
```

### –ü—Ä–æ–±–ª–µ–º–∞: GitHub Actions –Ω–µ –º–æ–∂–µ—Ç –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –≤ Security Group —Ä–∞–∑—Ä–µ—à–µ–Ω SSH (–ø–æ—Ä—Ç 22)
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å `EC2_HOST` –≤ secrets
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ SSH –∫–ª—é—á —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω –ø–æ–ª–Ω–æ—Å—Ç—å—é

### –ü—Ä–æ–±–ª–µ–º–∞: –î–µ–ø–ª–æ–π –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è

–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ:
- –≠—Ç–æ merge –∏–∑ develop –≤ main
- –í—Å–µ —Å–µ–∫—Ä–µ—Ç—ã –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã
- –¢–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ:

```bash
# –ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ EC2
ssh -i your-key.pem ubuntu@YOUR_EC2_IP

# –õ–æ–≥–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
tail -f /home/ubuntu/app/app.log

# –ü—Ä–æ—Ü–µ—Å—Å—ã Python
ps aux | grep python

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Ä—Ç–∞
sudo netstat -tulpn | grep 8000
```

### GitHub Actions –ª–æ–≥–∏:

1. –û—Ç–∫—Ä–æ–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –Ω–∞ GitHub
2. –í–∫–ª–∞–¥–∫–∞ "Actions"
3. –í—ã–±–µ—Ä–∏—Ç–µ –ø–æ—Å–ª–µ–¥–Ω–∏–π workflow
4. –°–º–æ—Ç—Ä–∏—Ç–µ –¥–µ—Ç–∞–ª–∏ –∫–∞–∂–¥–æ–≥–æ —à–∞–≥–∞

## üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:

1. **–û–≥—Ä–∞–Ω–∏—á—å—Ç–µ SSH –¥–æ—Å—Ç—É–ø**
   ```
   Source –¥–ª—è SSH: —Ç–æ–ª—å–∫–æ –≤–∞—à IP –≤–º–µ—Å—Ç–æ 0.0.0.0/0
   ```

2. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –æ—Ç–¥–µ–ª—å–Ω—ã–π –∫–ª—é—á –¥–ª—è –¥–µ–ø–ª–æ—è**
   ```bash
   # –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π –∫–ª—é—á
   ssh-keygen -t rsa -b 4096 -f ~/.ssh/deploy_key
   
   # –î–æ–±–∞–≤—å—Ç–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä
   ssh-copy-id -i ~/.ssh/deploy_key.pub ubuntu@YOUR_EC2_IP
   ```

3. **–†–æ—Ç–∞—Ü–∏—è –∫–ª—é—á–µ–π**
   - –ú–µ–Ω—è–π—Ç–µ SSH –∫–ª—é—á–∏ —Ä–∞–∑ –≤ 3-6 –º–µ—Å—è—Ü–µ–≤
   - –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ä–∞–∑–Ω—ã–µ –∫–ª—é—á–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏–π

## üéØ –ß–µ–∫-–ª–∏—Å—Ç –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏

–ü–µ—Ä–µ–¥ –ø–µ—Ä–≤—ã–º –¥–µ–ø–ª–æ–µ–º —É–±–µ–¥–∏—Ç–µ—Å—å:

- [ ] EC2 –∏–Ω—Å—Ç–∞–Ω—Å –∑–∞–ø—É—â–µ–Ω –∏ –¥–æ—Å—Ç—É–ø–µ–Ω
- [ ] Python 3.11+ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
- [ ] –î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è `/home/ubuntu/app` —Å–æ–∑–¥–∞–Ω–∞
- [ ] Security Group –Ω–∞—Å—Ç—Ä–æ–µ–Ω (–ø–æ—Ä—Ç—ã 22, 8000)
- [ ] GitHub Secrets –¥–æ–±–∞–≤–ª–µ–Ω—ã:
  - [ ] `EC2_SSH_KEY`
  - [ ] `EC2_HOST`
  - [ ] `EC2_USER`
- [ ] SSH –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤—Ä—É—á–Ω—É—é
- [ ] develop –≤–µ—Ç–∫–∞ —Å–æ–∑–¥–∞–Ω–∞
- [ ] Workflow —Ñ–∞–π–ª `.github/workflows/deploy-ec2.yml` –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏

## üöÄ –ü–µ—Ä–≤—ã–π –¥–µ–ø–ª–æ–π

```bash
# 1. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –≤—ã –≤ develop
git checkout develop

# 2. –ó–∞–∫–æ–º–º–∏—Ç—å—Ç–µ —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
git add .
git commit -m "feat: setup deployment to AWS EC2"
git push origin develop

# 3. –°–º–µ—Ä–∂–∏—Ç–µ –≤ main
git checkout main
git merge develop
git push origin main

# 4. –°–ª–µ–¥–∏—Ç–µ –∑–∞ –ø—Ä–æ—Ü–µ—Å—Å–æ–º –≤ GitHub Actions
# GitHub ‚Üí Actions ‚Üí Deploy to AWS EC2

# 5. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–µ–ø–ª–æ–π
curl http://YOUR_EC2_IP:8000/deployment
```

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç:

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ GitHub Actions
2. –ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ EC2 –∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤—Å–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ —á–µ–∫-–ª–∏—Å—Ç—É
4. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ Security Group –Ω–∞—Å—Ç—Ä–æ–µ–Ω –ø—Ä–∞–≤–∏–ª—å–Ω–æ

---

**–ì–æ—Ç–æ–≤–æ!** –ü–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∫–∞–∂–¥—ã–π merge –∏–∑ develop –≤ main –±—É–¥–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–µ–ø–ª–æ–∏—Ç—å—Å—è –Ω–∞ –≤–∞—à EC2 —Å–µ—Ä–≤–µ—Ä! üéâ
